from prefect import flow, task
import time

# 1. å®šç¾© Task (å…·é«”è¦åšå˜…é‡)
@task
def say_hello():
    print("ğŸ‘‹ Hello from Windows!")
    return "Done"

# 2. å®šç¾© Flow (å°‡ Tasks ä¸²è¯èµ·ä¾†)
@flow(log_prints=True)  # log_prints=True ç¢ºä¿ä½ å˜… print æœƒé¡¯ç¤ºåœ¨ UI
def my_flow():
    print("ğŸš€ Starting flow...")
    say_hello()

# 3. è¨­å®š Schedule (é€™æ˜¯ Prefect æœ€å±ˆæ©Ÿæ–¹ä¾¿çš„åœ°æ–¹: .serve)
if __name__ == "__main__":
    # é€™è¡ŒæŒ‡ä»¤æœƒä»¤é€™å€‹ Script è®Šæˆä¸€å€‹é•·é§ processï¼Œè‡ªå‹•æ¯åˆ†é˜è·‘ä¸€æ¬¡
    my_flow.serve(
        name="my-windows-deployment",
        cron="* * * * *"  # æ¯åˆ†é˜ä¸€æ¬¡
    )

