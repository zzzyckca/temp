import pandas as pd
from TM1py import TM1Service

# --- é€£ç·šè¨­å®š ---
TM1_CONFIG = {
    'address': 'localhost',  # ğŸ”‘ å¡«å› IP
    'port': 12345,           # ğŸ”‘ å¡«å› HTTPPort
    'user': 'admin',
    'password': 'password',
    'ssl': True
}

def main():
    CUBE_NAME = "cb_reporting" # ğŸ”‘ ç¢ºèªä½ çš„ Cube å

    try:
        with TM1Service(**TM1_CONFIG) as tm1:
            print(f"æ­£åœ¨æª¢æŸ¥ Cube [{CUBE_NAME}] çš„çµæ§‹...\n")
           Â 
            # å–å¾— Cube çš„æ‰€æœ‰ç¶­åº¦
            dimensions = tm1.cubes.get_dimension_names(CUBE_NAME)
           Â 
            print(f"âœ… é€™å€‹ Cube ç¸½å…±æœ‰ {len(dimensions)} å€‹ç¶­åº¦ï¼š")
            print("-" * 30)
            for i, dim_name in enumerate(dimensions):
                print(f"{i+1}. {dim_name}")
            print("-" * 30)
           Â 
            print("\nâš ï¸ è«‹æª¢æŸ¥ä½ çš„ Python Script æ˜¯å¦åŒ…å«äº†ä»¥ä¸Š **æ‰€æœ‰** ç¶­åº¦ã€‚")
            print("å¦‚æœæœ‰ä»»ä½•ä¸€å€‹ç¶­åº¦ä¸åœ¨ä½ çš„ context_map è£¡ï¼Œè«‹è£œä¸Šå»ï¼")

    except Exception as e:
        print(f"âŒ éŒ¯èª¤: {e}")

if __name__ == "__main__":
    main()
