import pandas as pd
from TM1py import TM1Service

# --- é€£ç·šè¨­å®š (ä½ å·²ç¶“æˆåŠŸé€£åˆ°çš„è¨­å®š) ---
TM1_CONFIG = {
    'address': 'YOUR_IP_ADDRESS', # å¡«ç•ªä½ é€£åˆ°æœå€‹ IP
    'port': 12345,                # å¡«ç•ªä½ é€£åˆ°æœå€‹ Port
    'user': 'admin',
    'password': 'password',
    'ssl': True
}

def main():
    try:
        with TM1Service(**TM1_CONFIG) as tm1:
            print("é€£ç·šæˆåŠŸï¼æ­£åœ¨æª¢æŸ¥ Dimension æˆå“¡...")

            # --- è«‹ä¿®æ”¹é€™è£¡ï¼šä½ æƒ³æª¢æŸ¥æ—¢ Dimension åç¨± ---
            # æ ¹æ“šä½ æˆªåœ–ï¼Œè©¦ä¸‹æª¢æŸ¥ 'Account' æˆ–è€… 'Operating_Unit'
            target_dimension = "Account" 
            
            # é€™è£¡æˆ‘å€‘æœå°‹åŒ…å« "BS174" çš„æˆå“¡ï¼Œç‡ä¸‹ä½¢çœŸèº«ä¿‚å’©
            search_keyword = "BS174" 

            print(f"æ­£åœ¨æœå°‹ [{target_dimension}] è£¡é¢åŒ…å« '{search_keyword}' çš„æˆå“¡...\n")
            
            # æŠ“å–è©²ç¶­åº¦çš„ Hierarchy (é€šå¸¸å«åŒå)
            hierarchy = tm1.dimensions.hierarchies.get(target_dimension, target_dimension)
            
            # éæ­·æ‰€æœ‰æˆå“¡æµçœŸå
            found = False
            members = tm1.elements.get_element_names(target_dimension, target_dimension)
            
            for member_name in members:
                if search_keyword.lower() in member_name.lower():
                    print(f"ğŸ” æ‰¾åˆ°çœŸå (Principal Name): '{member_name}'")
                    
                    # é †ä¾¿ç‡ä¸‹ä½¢æ—¢ Alias (åˆ¥å)
                    attributes = tm1.elements.get_element_attributes(target_dimension, target_dimension, member_name)
                    print(f"   -> Attributes (Alias): {attributes}")
                    found = True

            if not found:
                print(f"âŒ æµå””åˆ°åŒ…å« '{search_keyword}' çš„æˆå“¡ã€‚å¯èƒ½ Dimension åéŒ¯å·¦ï¼Ÿ")

    except Exception as e:
        print(f"ç™¼ç”ŸéŒ¯èª¤: {e}")

if __name__ == "__main__":
    main()